# Status Report - 2026-02-08

## The "Control & Visibility" Update (v0.9.0)

This session focused on hardening the WineBot environment for reliable interactive use and automated control.

### Major Accomplishments
1.  **Input Broker & Policy:**
    -   Implemented a central **Input Broker** in the API.
    -   Enforced **"User Always Wins"** policy: Agent input is blocked by default; User input revokes Agent control immediately.
    -   Added API endpoints: `/control/grant`, `/control/renew`, `/user_intent`.

2.  **Visual & UX Overhaul:**
    -   **Resolution:** Standardized on **1280x720** for efficiency and compatibility.
    -   **System Tray:** Integrated **`tint2`** panel for a reliable taskbar and tray area, replacing the flaky Wine internal tray.
    -   **Theme:** Applied "WineBot Blue" (`#3A6EA5`) background and `Liberation` fonts for consistent OCR/CV.
    -   **Feedback:** Added an **Agent Crosshair** overlay in the Dashboard to visualize automation intent.

3.  **Stability & Diagnostics:**
    -   **Startup:** Rewrote `entrypoint.sh` to eliminate Xvfb/Wineserver race conditions and prevent double-execution.
    -   **Tracing:** Fixed gaps in Windows-layer tracing and VNC network probing.
    -   **Recording:** Fixed VTT subtitle timing bugs; input events now align perfectly with video.
    -   **Validation:** Created `scripts/diagnose-master.sh` - a comprehensive end-to-end test suite (Passes 100%).

### Known Issues / Quirks
-   **Vulkan Warning:** `err:vulkan:vulkan_init_once` appears in logs but is benign for 2D automation.
-   **Window Decorations:** Wine Explorer is now forced to have decorations to ensure movability, which may look slightly "double-bordered" in some contexts but is functional.

### Next Steps
1.  **Documentation:** Update `README.md` to document the new Control API and `tint2` usage.
2.  **Multi-Monitor:** Investigate Xinerama support for larger/dual-head workloads.
3.  **Agent Integration:** Update external agents to use the new `/control/grant` flow before attempting input.
